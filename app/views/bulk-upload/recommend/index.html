{% extends "_templates/_page.html" %}

{% set navActive = 'bulk' %}

{% set filteredRecords = data.records | filterRecords(data) %}
{% set currentTrainees = filteredRecords | filterByStatus("Draft", true) | filterByActive %}

{% set traineesThatCanBeRecommended = currentTrainees | filterByComplete | filterByStatus(["Deferred", "Withdrawn", "QTS recommended", "QTS awarded", "EYTS recommended", "EYTS awarded"], true) %}

{% set qtsTrainees = traineesThatCanBeRecommended | filterOutEarlyYears %}
{% set eytsTraineeCount = traineesThatCanBeRecommended | length - qtsTrainees | length %}

{% set qualText = [] %}
{% set qualText = qualText | push("QTS") if qtsTrainees | length > 0 %}
{% set qualText = qualText | push("EYTS") if eytsTraineeCount > 0 %}

{% set needAcademicAward = traineesThatCanBeRecommended | filterByAcademicQualificationsApply %}

{% set fileName = data.signedInProviders | makeFileName("trainees to recommend","csv") %}

{% set pageHeading = "Recommend trainees for " + qualText | orSeparate %}

{% block content %}

  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds-from-desktop">
      <h1 class="govuk-heading-l">
        <span class="govuk-caption-l">{{ data.signedInProviders | andSeparate }}</span>
        {# {{ pageHeading }} #}
        Recommend trainees for <span class="app-nowrap">{{ qualText | orSeparate }}</span>
      </h1>
      <p class="govuk-body">
        You have {{ traineesThatCanBeRecommended | length }} trainees ready to be recommend for {{ qualText | orSeparate }}.
      </p>
      <h2 class="govuk-heading-m">
        1. Export trainee records
      </h2>
      <p class="govuk-body">
        <a href="../public/downloads/recommend.csv" download="{{ fileName }}" class="govuk-link">
          Export trainee records with missing details (csv)
        </a>
      </p>
      <h2 class="govuk-heading-m">
        2. Add details of the trainees outcome
      </h2>
      <p class="govuk-body">
        Open ‘{{ fileName }}’ in <span class="app-nowrap">spreadsheet software</span> (for example, <span class="app-nowrap">Microsoft Excel</span>) and add when the trainee met {{ qualText | orSeparate }} {{ "and their postgraduate academic qualification" if needAcademicAward | filterByPostgraduate }}.
      </p>
      <p class="govuk-body">
        You can leave rows or cells empty if you do not want to recommend the trainees for {{ qualText | orSeparate }}.
      </p>
      <h3 class="govuk-heading-s">
        When the trainee meet {{ qualText | orSeparate }}
      </h3>
      <p class="govuk-body">
        In the column ‘Date standards met’ add the date the trainee
        was awarded teacher status.
      </p>
      <p class="govuk-body">
        The date must be written in the format <span class="app-nowrap">‘DD/MM/YYYY’</span>.
        For example, if the trainee was awarded teacher status on <span class="app-nowrap">20 June {{ data.years.defaultCourseYear }}</span>, write <span class="app-nowrap">‘20/07/{{ data.years.defaultCourseYear }}’</span>.
      </p>
      <p class="govuk-body">
        If the trainee has not met QTS or EYTS standards, withdraw them manually.
      </p>
      <h3 class="govuk-heading-s">
        Postgraduate academic qualification
      </h3>
      {% if needAcademicAward | filterByPostgraduate %}
        {# Notes - consider tolerating 'None' for routes that are not
        postgrad #}
        <p class="govuk-body">
          For postgraduate trainees, in the column ‘Postgraduate qualification’ add one of these
          options:
        </p>
        <ul class="govuk-list govuk-list--bullet">
          <li>PCGE</li>
          <li>PGDE</li>
          <li>None</li>
        </ul>
        <p class="govuk-body">
          If the trainee was not on a postgraduate course, leave the cell blank.
        </p>
      {% endif %}

      <h2 class="govuk-heading-m">
        3. Upload file
      </h2>
      <form action="/bulk-upload/recommend/errors-found" method="post" novalidate>
        {{ govukFileUpload({
          id: "file-upload-1",
          name: "file-upload-1",
          hint: {
            text: "File type must be ‘csv’."
          },
          label: {
            text: "Upload a file"
          }
        }) }}
        {{ govukButton({
          text: "Upload records"
        }) }}
      </form>
    </div>
  </div>

{% endblock %}


