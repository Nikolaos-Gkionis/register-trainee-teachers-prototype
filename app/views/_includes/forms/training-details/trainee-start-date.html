{% set commencementStartDateArray = record.trainingDetails.commencementDate | toDateArray %}

{% set traineeStartDate = record.trainingDetails.commencementDate or false %}
{% set commencementDateHint = "Their ITT started " + record.courseDetails.startDate | dateToGovukDate %}

{# TO DO — throw error if no course start date #}
{# TO DO — if withdrawing/deferring give different option – "They did not start the course" #}

{% set legendText = "Trainee start date" %}
{% set hintHtml = "For example, " + today() | toDateArray | spaceSeparate %}

{% set commencementDateInputHtml %}
  {{ govukDateInput({
    id: commencementDateID,
    namePrefix: "record[trainingDetails][commencementDate]",
    fieldset: {
      legend: {
        text: legendText
      }
    },
    hint: {
      html: hintHtml
    },
    items: [
        {
          name: "day",
          classes: "govuk-input--width-2",
          value: commencementStartDateArray["0"]
        },
        {
          name: "month",
          classes: "govuk-input--width-2",
          value: commencementStartDateArray["1"]
        },
        {
          name: "year",
          classes: "govuk-input--width-4",
          value: commencementStartDateArray["2"]
        }
      ]
  }) }}
{% endset %}

{% if not traineeStartDate %}

  {{ govukRadios({
    fieldset: {
      legend: {
        text: pageHeading,
        isPageHeading: true,
        classes: "govuk-fieldset__legend--l"
      }
    },
    hint: {
      text: commencementDateHint
    },
    items: [
      {
        value: "use-course-start-date",
        text: "Yes"
      },
      {
        value: "true",
        text: "No, they started later",
        conditional: {
          html: commencementDateInputHtml
        }
      },
      {
        divider: "or"
      },
      {
        value: "trainee-not-started",
        text: "They have not started yet"
      }
    ]
  } | decorateAttributes(record, "record.trainingDetails.traineeStarted")) }}

{% else %}

  {# If the trainee start exists, use date input for editing #}

  {{ govukDateInput({
    fieldset: {
      legend: {
        text: "When did the trainee start their ITT?",
        isPageHeading: true,
        classes: "govuk-fieldset__legend--l"
      }
    },
    hint: {
      html: hintHtml
    },
    items: [
        {
          name: "day",
          classes: "govuk-input--width-2",
          value: commencementStartDateArray["0"]
        },
        {
          name: "month",
          classes: "govuk-input--width-2",
          value: commencementStartDateArray["1"]
        },
        {
          name: "year",
          classes: "govuk-input--width-4",
          value: commencementStartDateArray["2"]
        }
      ]
  } | decorateAttributes(record, "record.trainingDetails.commencementDate")) }}

{% endif %}

{{ govukButton({
  text: "Continue"
}) }}

