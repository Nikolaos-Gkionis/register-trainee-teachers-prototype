{% extends "_templates/_page.html" %}

{% set pageHeading = "Review updates to trainee records" %}
{% set navActive = 'bulk' %}

{% set currentTrainees = data.filteredRecords | filterByStatus("Draft", true) | filterByActive %}

{% set traineesThatCanBeUpdated = currentTrainees | filterByIncomplete | filterOutEarlyYears | filterByStatus(["Deferred", "Withdrawn"], true) %}
{% set traineesThatCanBeRecommended = currentTrainees | filterByComplete | filterByStatus(["Deferred", "Withdrawn", "QTS recommended", "QTS awarded", "EYTS recommended", "EYTS awarded"], true) %}
{% set qualText = ["QTS"] %}
{% set qualText = qualText | push("EYTS") if (traineesThatCanBeRecommended | filterOutEarlyYears) != traineesThatCanBeRecommended %}

{% set traineesThatCannotBeUpdatedCount = (currentTrainees | filterByIncomplete | length) - (traineesThatCanBeUpdated | length ) %}

{% block content %}

  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      {{ govukPanel({
        titleText: traineesThatCanBeUpdated | length  + " trainee records updated",
        classes: "govuk-!-margin-bottom-7"
      }) }}

      <p class="govuk-body">
        <a href="/records">
          View your trainee records
        </a>
      </p>
      <h2 class="govuk-heading-m">
        Next steps
      </h2>
      <h3 class="govuk-heading-s">
        Trainees with incomplete records
      </h3>
      {% include "_includes/bulk-action--update-individual-records.html" %}
      <h3 class="govuk-heading-s">
        Recommend trainees for {{ qualText | orSeparate }}
      </h3>
      <p class="govuk-body">
        You have {{ traineesThatCanBeRecommended | length }} trainees that can be recommended for {{ qualText | orSeparate }}.
      </p> 
      <p class="govuk-body">
        <a href="/bulk-action/">Bulk recommend trainees for {{ qualText | orSeparate }}</a>
      </p>
    </div>
  </div>

{% endblock %}


